@model IEnumerable<SfDesk.Models.Vehicle>

<link href="~/assets/css/jsGrid.min.css" rel="stylesheet" />
<link href="~/assets/css/jsGrid-theme.min.css" rel="stylesheet" />
<div id="main-content">
    <div class="row">
        <div class="col-lg-12">
            <div class="card alert">
                <div class="jsGrid-table-panel">
                    <div id="jssGrid" class="table table-striped table-bordered dataTable no-footer"></div>
                </div>
            </div>
            <!-- /# card -->
        </div>
        <!-- /# column -->
    </div>
</div>

<script src="~/assets/js/db.js"></script>
<script src="~/assets/js/jsGrid.js"></script>
<script>
    var arr=[];
    $(document).ready(function(){
        debugger;
        var id = $('#Transporter_ID').val();
        if (id ==  null || id== "")
        {
            var id = $('#T_ID').val();
        }
       
        $.ajax({
            type: "GET",
            url: "/Transporter/Vehcile_Get_By_Transporter",
            dataType: "json",
            data: { id: id },
            success: function (d) {
                arr = d;
                my()
            }
        });
    });
     
   
    function my()
    {
                $("#jssGrid").jsGrid({
                    
                    controller: {
                        
                        insertItem: function (insertingClient) {
                            
                            // this.clients.push(insertingClient);
                            $.ajax({
                                type: "POST",
                                data: insertingClient,
                                url: "/Transporter/Add_Vehicle",
                                success: function (d) {
                                    alert(d);
                                    $('#Vehicle_ID').append('<option value=' + d.V_ID + '>' + d.Vehicle_Type + ' </option>');

                                    arr.push(insertingClient);

                                },
                            })
                        },
                        updateItem: function (updatingClient) {
                            $.ajax({
                                type: "POST",
                                data: updatingClient,
                                url: "update_vehicle",
                                success: function (d) {
                                    alert(d);
                                },
                            })
                        },

                        deleteItem: function (deletingClient) {
                            $.ajax({
                                type: "GET",
                                data: deletingClient,
                                url: "Delete_vehicle",
                                success: function (d) {
                                    alert(d);
                                },
                            })
                        }
                    },
                    onItemInserted: function (args) {

                        jQuery("#jsGrid").jsGrid("destroy");
                        my();


                    },
                    onItemInserting: function (args) {
                        debugger
                        var a = $('#Transporter_ID').val();
                        if (a == null) {
                            a = $('#T_ID').val();
                        }
                        args.item["T_ID"] = a;


                        $("#grid").jsGrid("insertItem", args.item);
                    },
                    height: "auto",
                    width: "100%",
                    filtering: false,
                    editing: true,
                    inserting: true,
                    sorting: true,
                    paging: true,
                    autoload: true,
                    pageSize: 15,
                    pageButtonCount: 5,
                    deleteConfirm: "Do you rete the client?",
                    data: arr,
                    pagerContainer: null,
                    pageIndex: 1,
                    pageSize: 20,
                    pageButtonCount: 15,
                    pagerFormat: "Pages: {first} {prev} {pages} {next} {last}    {pageIndex} of {pageCount}",
                    pagePrevText: "Prev",
                    pageNextText: "Next",
                    pageFirstText: "First",
                    pageLastText: "Last",
                    pageNavigatorNextText: "...",
                    pageNavigatorPrevText: "...",

                    invalidMessage: "Invalid data entered!",
            
                    fields: [
                    {name:"V_ID", title: "@Html.DisplayNameFor(m => m.V_ID)", type: "number", width:  80, validate: "required",  },
                    {name:"Vehicle_Type", title: "@Html.DisplayNameFor(m=>m.Vehicle_Type)", type: "text", width:  80, validate: "required" },
                    {name:"Vehicle_No", title: "@Html.DisplayNameFor(m=>m.Vehicle_No)", type: "text", width:  80, validate: "required" },
                    {name:"Rate", title: "@Html.DisplayNameFor(m=>m.Rate)", type: "text", width:  80, validate: "required" },

                        { type: "control" }
                    ]
                });

            };

</script>
