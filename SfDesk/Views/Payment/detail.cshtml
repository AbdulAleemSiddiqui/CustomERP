@model  IEnumerable < SfDesk.Models.Payment_Mode>


<link href="~/assets/css/jsgrid.min.css" rel="stylesheet" />
<link href="~/assets/css/jsgrid-theme.min.css" rel="stylesheet" />
<style>
    .total-row td {
        border-top: 2px solid #efefef;
    }
</style>
<div id="main-content">
    <div class="row">
        <div class="col-lg-12">
            <div class="card alert">
                <div class="jsgrid-table-panel">
                    <div id="jsGrid" class="table table-striped table-bordered dataTable no-footer"></div>
                    <br />
                    <hr />
                    <div id="Grid" class="table table-striped table-bordered dataTable no-footer"></div>

                </div>
                <!-- /# card -->
            </div>
            <!-- /# column -->
        </div>
    </div>
</div>


    @*  <script src="~/assets/js/db.js"></script>*@
    <script>
        var pdata = [];
        var CO=[]
        
        var array =@Html.Raw(Json.Encode(Session["COA"]));
        $(document).ready(function () {
            CO =@Html.Raw(Json.Encode(Session["COA"]));

        loadData()
    });
        function loadData() {
            debugger

            $.ajax({
                type: "GET",
                url: "index",
                data: { PI_ID:  $('#PI_ID').val() },
                dataType: "json",
                success: function (d) {

                    if (d.ID != 0)
                        arr = d
                    my()
                }
            });
            debugger;
       my();
    }






    function my(){
        $("#jsGrid").jsGrid({

            height: "auto",
            width: "100%",
            filtering: false,
            editing: false,
            inserting: true,
            sorting: true,
            paging: true,
            autoload: true,
            pageSize: 15,
            pageButtonCount: 5,
            deleteConfirm: "confirm",
            data: pdata,
            controller: {
                insertItem: function (insertingClient) {

                    // this.clients.push(insertingClient);
                    $.ajax({
                        type: "POST",
                        data: {PI_ID : $('#PI_ID').val() , s : insertingClient },
                        url: "Save_Charges",
                        success: function (d) {
                            alert(d);


                        },
                    })
                },
                deleteItem: function (deletingClient) {
                    $.ajax({
                        type: "GET",
                        data: deletingClient,
                        url: "Delete",
                        success: function (d) {
                            alert(d);
                        },
                    })
                }
            },
            pagerContainer: null,
            pageIndex: 1,
            pageSize: 20,
            pageButtonCount: 15,
            pagerFormat: "Pages: {first} {prev} {pages} {next} {last}    {pageIndex} of {pageCount}",
            pagePrevText: "Prev",
            pageNextText: "Next",
            pageFirstText: "First",
            pageLastText: "Last",
            pageNavigatorNextText: "...",
            pageNavigatorPrevText: "...",

            invalidMessage: "Invalid data entered!",

            onItemInserting: function (args) {


                args.item["PI_ID"] = Master_Id;



                $("#grid").jsGrid("insertItem", args.item);
            },

            fields: [

            {
                name: "Account_ID", title: "Account", type: "select", width: 80, validate: "required",
            items: CO, valueField: "COA_ID", textField: "COA_Name",

            },
            { name: "Description", title: "Description",  type: "text", width: 80, validate: "required" },
               {
                   name: "PaymentMode", title: "payment Mode", type: "select", width: 80, validate: "required",
                   items: ["Cash","Check"],

               },
          { name: "Amount", title: "Amount", type: "number", width: 80, validate: "required" },


            { type: "control",editButton: false,
                itemTemplate: function(_, item) {

                            if(item.IsTotal)
                                return "";
                            return jsGrid.fields.control.prototype.itemTemplate.apply(this, arguments);
                        }}

            ]

        });
        $("#Grid").jsGrid({

            height: "auto",
            width: "100%",
            filtering: false,
            editing: false,
            inserting: true,
            sorting: true,
            paging: true,
            autoload: true,
            pageSize: 15,
            pageButtonCount: 5,
            deleteConfirm: "confirm",
            data: pdata,
            controller: {
                insertItem: function (insertingClient) {

                    // this.clients.push(insertingClient);
                    $.ajax({
                        type: "POST",
                        data: {PI_ID : $('#PI_ID').val() , s : insertingClient },
                        url: "Save_Charges",
                        success: function (d) {
                            alert(d);


                        },
                    })
                },



                deleteItem: function (deletingClient) {
                    $.ajax({
                        type: "GET",
                        data: deletingClient,
                        url: "Delete",
                        success: function (d) {
                            alert(d);
                        },
                    })
                }
            },
            pagerContainer: null,
            pageIndex: 1,
            pageSize: 20,
            pageButtonCount: 15,
            pagerFormat: "Pages: {first} {prev} {pages} {next} {last}    {pageIndex} of {pageCount}",
            pagePrevText: "Prev",
            pageNextText: "Next",
            pageFirstText: "First",
            pageLastText: "Last",
            pageNavigatorNextText: "...",
            pageNavigatorPrevText: "...",

            invalidMessage: "Invalid data entered!",

            onItemInserting: function (args) {


                args.item["PI_ID"] = Master_Id;



                $("#grid").jsGrid("insertItem", args.item);
            },

            fields: [

            {
                name: "Account_ID", title: "Ref. No", type: "text", width: 80, validate: "required" },
            { name: "Description", title: "Trans Date",  type: "text", width: 80, validate: "required" },
              
          { name: "Amount", title: "Invoice Total", type: "text", width: 80, validate: "required" },
          { name: "Amount", title: "Invoice Taxes", type: "number", width: 80, validate: "required" },  
          { name: "Amount", title: "Due Amount", type: "text", width: 80, validate: "required" },
          { name: "Amount", title: "Recipt", type: "number", width: 80, validate: "required" },
          { name: "Amount", title: "Total", type: "number", width: 80, validate: "required" },


            { type: "control",editButton: false,
                itemTemplate: function(_, item) {

                    if(item.IsTotal)
                        return "";
                    return jsGrid.fields.control.prototype.itemTemplate.apply(this, arguments);
                }}

            ]

        });
    }
    </script>
