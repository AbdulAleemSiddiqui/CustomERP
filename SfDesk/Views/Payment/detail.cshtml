@model  IEnumerable<SfDesk.Models.Payment_Mode>


<link href="~/assets/css/jsgrid.min.css" rel="stylesheet" />
<link href="~/assets/css/jsgrid-theme.min.css" rel="stylesheet" />
<style>
    .total-row td {
        border-top: 2px solid #efefef;
    }
</style>
<div id="main-content">
    <div class="row">
        <div class="col-lg-12">
            <div class="card alert">
                <div class="jsgrid-table-panel">

                    <div id="jsGrid" class="table table-striped table-bordered dataTable no-footer"></div>
                    <div id="child2"></div>
                </div>
                <!-- /# card -->
            </div>
            <!-- /# column -->
        </div>
    </div>
</div>
<script>
    
    var CO=[]
    $(document).ready(function () {
       
        
         CO =@Html.Raw(Json.Encode(Session["COA"]));
     my();
        
    });
    function my()
    {
        $("#jsGrid").jsGrid({

            height: "auto",
            width: "100%",
            filtering: false,
            editing: true,
            inserting: true,
            sorting: true,
            paging: true,
            autoload: true,
            pageSize: 15,
            pageButtonCount: 5,
            deleteConfirm: "confirm",
            data: pdata,
            controller: {
                updateItem: function (insertingClient) {
                    debugger
                    details.push(insertingClient);

                },
                insertItem: function (insertingClient) {
                    debugger
                    details.push(insertingClient);

                },
                deleteItem: function (deletingClient) {
                    details.pop(insertingClient);
                   
                }
            },
                pagerContainer: null,
                pageIndex: 1,
                pageSize: 20,
                pageButtonCount: 15,
                pagerFormat: "Pages: {first} {prev} {pages} {next} {last}    {pageIndex} of {pageCount}",
                pagePrevText: "Prev",
                pageNextText: "Next",
                pageFirstText: "First",
                pageLastText: "Last",
                pageNavigatorNextText: "...",
                pageNavigatorPrevText: "...",
                onRefreshed: function(args) {
                    var items = args.grid.option("data");
                    debugger;
                    totalamount = 0;
                    items.forEach(function(item) {
                        totalamount += parseFloat(item.Amount);
                       
                    });
                    
                },
                invalidMessage: "Invalid data entered!",

     

                fields: [

                {
                    name: "Account_ID", title: "Account", type: "select", width: 80, validate: "required",
                    items: CO, valueField: "COA_ID", textField: "COA_Name",

                },
                { name: "Description", title: "Description", type: "text", width: 80, validate: "required" },
                   {
                       name: "PaymentMode", title: "payment Mode", type: "select", width: 80, validate: "required",
                       items: ["Cash", "Chaque","bank transfer","Credit Card"] ,
                       insertTemplate: function () {
                           var $insertControl = jsGrid.fields.select.prototype.insertTemplate.call(this);
                           var th= this;
                           $insertControl.on("change", function () {
                               debugger;
                               var check = th._grid.fields[3];
                               var selected = this.value;
                               if(selected == "1")
                               {
                                   check.inserting = true;
                               }
                               else
                               {
                                   check.inserting = false;
                               }
                               var $check = jsGrid.fields.text.prototype.insertTemplate.call(check);

                               var a = $(".check").empty();
                               $(".check").append($check);
                           });
                           return $insertControl;
                       },
                       editTemplate: function (args) {
                           var $editControl = jsGrid.fields.select.prototype.editTemplate.call(this,args);
                           var th= this;
                           $editControl.on("change", function () {
                               var check = th._grid.fields[3];
                               var selected = this.value;
                               if(selected == "1")
                               {
                                   check.editing = true;
                               }
                               else
                               {
                                   check.editing = false;
                               }
                               var $check = jsGrid.fields.text.prototype.editTemplate.call(check);

                               var a = $(".checke").empty();
                               $(".checke").append($check);

                           });
                           return $editControl;
                       },
                   },

              { name: "CheckNO", title: "Check NO.", type: "text", width: 80,editing: false,    inserting: false,insertcss:"check",editcss:"checke",},
              { name: "Amount", title: "Amount", type: "text", width: 80, validate: "required" , css: "totalAmount" },


                {
                    type: "control", 
                    itemTemplate: function (_, item) {

                   
                        return jsGrid.fields.control.prototype.itemTemplate.apply(this, arguments);
                    }
                }

                ]

            });
    }
    </script>
